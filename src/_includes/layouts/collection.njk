---
layout: base.njk
title: "{{ sections[section].title or (section | title) }}"
showTitle: true
metaDisable: true
---

{% from "components/list-item.njk" import listItem %}
{% from "components/breadcrumbs.njk" import breadcrumbs %}

<div class="stack" style="--space: var(--space-xl)">
  {{ breadcrumbs([{ text: section | title }]) }}

  <header class="stack" style="--space: var(--space-xs)">
    <h1 class="text-h1">{{ sections[section].title or (section | title) }}</h1>
    {% if sections[section].intro %}
      <p class="max-w-prose text-lg opacity-70 leading-relaxed">{{ sections[section].intro }}</p>
    {% endif %}
  </header>

  <!-- Controls Cluster -->
  <div
    class="cluster justify-between items-center bg-base-200/50 p-space-s rounded-lg hb-accent-top"
    style="--space: var(--space-m)"
  >
    <div class="cluster" style="--space: var(--space-s)">
      <span class="text-[0.6rem] uppercase tracking-widest font-black opacity-40">View</span>
      <div class="join">
        <button class="btn btn-xs join-item btn-outline" type="button" data-view="comfort">
          Comfort
        </button>
        <button class="btn btn-xs join-item btn-ghost" type="button" data-view="dense">
          Dense
        </button>
      </div>
    </div>
    <div class="cluster" style="--space: var(--space-s)">
      <span class="text-[0.6rem] uppercase tracking-widest font-black opacity-40">Sort</span>
      <div class="join">
        <button class="btn btn-xs join-item btn-outline" type="button" data-sort="date">
          Date
        </button>
        <button class="btn btn-xs join-item btn-ghost" type="button" data-sort="title">
          Title
        </button>
      </div>
    </div>
  </div>

  <div
    id="collection-grid"
    class="grid-auto"
    style="--grid-min: 22rem; --space: var(--space-l)"
    data-section="{{ section }}"
  >
    {% for item in collections[section] %}
      {% if item.url != page.url %}
        <div
          class="group hb-anim"
          data-title="{{ (item.data.title or '') | escape }}"
          {% if item.date %}
            data-date="{{ item.date | htmlDateString }}"
          {% endif %}
        >
          {{ listItem(item) }}
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

<script>
;(() => {
  const grid = document.getElementById('collection-grid')
  if (!grid) return
  const items = Array.from(grid.children)

  function sortBy(key) {
    const s = items.slice().sort((a, b) => {
      if (key === 'title') return (a.dataset.title || '').localeCompare(b.dataset.title || '')
      if (key === 'date') {
        const da = new Date(a.dataset.date || 0).getTime()
        const db = new Date(b.dataset.date || 0).getTime()
        return db - da
      }
      return 0
    })
    // Maintain layout primitive classes while re-ordering
    s.forEach(el => grid.appendChild(el))
  }

  function setView(mode) {
    grid.style.setProperty('--space', mode === 'comfort' ? 'var(--space-l)' : 'var(--space-s)')
    grid.style.setProperty('--grid-min', mode === 'comfort' ? '22rem' : '18rem')

    items.forEach(el => {
      el.classList.toggle('opacity-90', mode === 'dense')
      el.classList.toggle('scale-[0.98]', mode === 'dense')
    })
  }

  document.querySelectorAll('[data-sort]').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('[data-sort]').forEach(b =>
        b.classList.toggle('btn-outline', b !== btn)
      )
      document.querySelectorAll('[data-sort]').forEach(b =>
        b.classList.toggle('btn-ghost', b === btn)
      )
      sortBy(btn.dataset.sort)
    })
  })

  document.querySelectorAll('[data-view]').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('[data-view]').forEach(b =>
        b.classList.toggle('btn-outline', b !== btn)
      )
      document.querySelectorAll('[data-view]').forEach(b =>
        b.classList.toggle('btn-ghost', b === btn)
      )
      setView(btn.dataset.view)
    })
  })

  setView('comfort')
  sortBy('date')
})()
</script>
