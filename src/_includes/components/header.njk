{% from "components/nav-items.njk" import navItems %}
{% from "components/icons.njk" import icon %}
{% macro header(nav, page) %}
  {% set navLabel = 'Primary navigation' %}
  <header class="sticky top-0 z-40 w-full bg-base-100/90 backdrop-blur shadow">
    <div class="navbar mx-auto max-w-screen-2xl px-6">
      <!-- Brand -->
      <div class="flex-1">
        <a href="/" class="flex items-center gap-2 font-heading text-3xl text-primary">
          {{ icon('flask-conical', { class: 'w-6 h-6', 'aria-hidden': 'true' }) }}
          <span>{{ 'Effusion Labs' | shout }}</span>
        </a>
      </div>

      <!-- Mobile nav (hidden on lg+) -->
      <div class="flex-none lg:hidden">
        <nav class="dropdown dropdown-end" aria-label="{{ navLabel }}">
          <label tabindex="0" class="btn btn-ghost btn-square" aria-label="Open menu">
            {{ icon('menu', { class: 'w-6 h-6', 'aria-hidden': 'true' }) }}
          </label>
          <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[100] p-2 shadow bg-base-100 rounded-box w-56" role="menu">
            {% if navItems %}
              {{ navItems(nav, page.url) }}
            {% else %}
              {% for n in nav %}
              <li role="none">
                <a role="menuitem" href="{{ n.url }}">
                  {% if n.order %}<span class="opacity-60">{{ n.order }}.</span>{% endif %}
                  <span>{{ n.title | shout }}</span>
                </a>
              </li>
              {% endfor %}
            {% endif %}
          </ul>
        </nav>
      </div>

      <!-- Right cluster: desktop nav -->
      <div class="flex-none flex items-center gap-2">
        <!-- Desktop nav (shown on lg+) -->
        <nav class="hidden lg:flex" aria-label="{{ navLabel }}">
          <ul class="menu menu-horizontal px-1">
            {% if navItems %}
              {{ navItems(nav, page.url, 'hover:text-primary') }}
            {% else %}
              {% for n in nav %}
              <li>
                <a href="{{ n.url }}" class="hover:text-primary">
                  {% if n.order %}<span class="opacity-60">{{ n.order }}.</span>{% endif %}
                  <span>{{ n.title | shout }}</span>
                </a>
              </li>
              {% endfor %}
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>
  </header>
{% endmacro %}
