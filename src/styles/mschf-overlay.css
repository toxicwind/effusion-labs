/* assets/css/mschf-overlay.css */
/* Effusion Labs — Hypebrüt Overlay v2 (Autonomous / Emergent / 2025-tier)
   Theme-tinted via currentColor + color-mix() clamps. Mobile-sane, print-safe. */

#mschf-overlay-root{
  pointer-events:none; position:fixed; inset:0; width:100vw; height:100vh;
  z-index:44; color:hsl(var(--p, 210 6% 96%));
  contain:layout style paint; content-visibility:auto;
}
@media print{ #mschf-overlay-root{ display:none } }

/* ————————————————— Base scaffold ————————————————— */

.mschf-grid{ position:absolute; inset:0; mix-blend-mode:screen; opacity:.08; }
.mschf-grid[data-variant="dots"]{
  background-image: radial-gradient(circle at 1px 1px, currentColor 1px, transparent 1.6px);
  background-size: 18px 18px;
}
.mschf-grid[data-variant="lines"]{
  background-image:
    linear-gradient(to right, color-mix(in oklab,currentColor 48%,transparent) 1px, transparent 1px),
    linear-gradient(to bottom, color-mix(in oklab,currentColor 48%,transparent) 1px, transparent 1px);
  background-size:24px 24px, 24px 24px;
}

.mschf-frame{ position:absolute; inset:0; border-radius:2px; pointer-events:none;
  box-shadow:
    inset 0 0 0 1px color-mix(in oklab,currentColor 22%,transparent),
    inset 0 0 0 2px color-mix(in oklab,currentColor 6%,transparent),
    inset 0 0 24px color-mix(in oklab,currentColor calc(var(--mschf-glow, .12)*100%), transparent);
}

.mschf-corner{ position:absolute; width:24px; height:24px;
  filter: drop-shadow(0 0 6px color-mix(in oklab,currentColor 25%,transparent));
}
.mschf-corner::before,.mschf-corner::after{ content:""; position:absolute; background:currentColor }
.mschf-corner-tl{ top:12px; left:12px } .mschf-corner-tr{ top:12px; right:12px }
.mschf-corner-bl{ bottom:12px; left:12px } .mschf-corner-br{ bottom:12px; right:12px }
.mschf-corner-tl::before,.mschf-corner-tr::before,.mschf-corner-bl::before,.mschf-corner-br::before{ width:18px; height:2px }
.mschf-corner-tl::after,.mschf-corner-tr::after,.mschf-corner-bl::after,.mschf-corner-br::after{ width:2px; height:18px }
.mschf-corner-tl::before{ top:0; left:0 }     .mschf-corner-tl::after{ top:0; left:0 }
.mschf-corner-tr::before{ top:0; right:0 }    .mschf-corner-tr::after{ top:0; right:0 }
.mschf-corner-bl::before{ bottom:0; left:0 }  .mschf-corner-bl::after{ bottom:0; left:0 }
.mschf-corner-br::before{ bottom:0; right:0 } .mschf-corner-br::after{ bottom:0; right:0 }

.mschf-scanline{ position:absolute; left:0; right:0; height:14vh; opacity:.18; mix-blend-mode:screen;
  background:linear-gradient(to bottom,
    color-mix(in oklab,currentColor 0%,transparent) 0%,
    color-mix(in oklab,currentColor 10%,transparent) 40%,
    color-mix(in oklab,currentColor 0%,transparent) 100%);
  animation:mschf-scan 6.5s linear infinite;
}
.mschf-scanline.static{ animation:none; opacity:.12; top:52%; transform:translateY(-50%) }
@keyframes mschf-scan{ 0%{ top:-20% } 100%{ top:120% } }
@media (prefers-reduced-motion: reduce){ .mschf-scanline{ animation:none } }

/* ————————————————— Ephemera ————————————————— */

.mschf-tape{
  position:absolute; left:0; display:inline-block; padding:6px 10px;
  font:600 10px/1.2 ui-monospace, SFMono-Regular, Menlo, monospace;
  color:#0c0c0c; text-transform:uppercase; letter-spacing:.08em;
  background: repeating-linear-gradient(90deg, rgba(255,255,255,.85) 0 10px, rgba(255,255,255,.82) 10px 20px);
  border:1px dashed rgba(0,0,0,.35);
  box-shadow: 0 1px 0 rgba(0,0,0,.6), 0 8px 18px rgba(0,0,0,.35);
  mix-blend-mode:normal; pointer-events:none; user-select:none;
}
.mschf-tape[data-hazard="1"]{
  background: repeating-linear-gradient(45deg, #ffd500 0 8px, #000 8px 16px);
  color:#0b0b0e; border-style:solid;
}
.mschf-tape[data-clear="1"]{
  background: linear-gradient(to bottom, rgba(255,255,255,.22), rgba(255,255,255,.08));
  color:#0b0b0e; border-style:dotted; backdrop-filter: blur(2px);
}
.mschf-tape.tone-a{ background: repeating-linear-gradient(90deg, #ffe9e9 0 10px, #fff1f1 10px 20px) }
.mschf-tape.tone-b{ background: repeating-linear-gradient(90deg, #fff8d6 0 10px, #fff0b8 10px 20px) }
.mschf-tape.tone-c{ background: repeating-linear-gradient(90deg, #e8fff0 0 10px, #dbffe9 10px 20px) }

.mschf-stamp{
  position:absolute; padding:6px 10px; font:700 11px/1.1 ui-monospace, SFMono-Regular, Menlo, monospace;
  text-transform:uppercase; letter-spacing:.12em;
  color: color-mix(in oklab, #ff2e63 90%, currentColor 10%);
  border:2px solid currentColor; background:transparent; pointer-events:none; user-select:none;
  filter: contrast(1.2) drop-shadow(0 2px 0 rgba(0,0,0,.25)); mix-blend-mode:multiply;
}

.mschf-quotes{
  position:fixed; font:700 12px/1.1 ui-monospace, SFMono-Regular, Menlo, monospace; letter-spacing:.08em;
  color: color-mix(in oklab,currentColor 85%, #fff 15%);
  background: color-mix(in oklab, #000 70%, transparent); border:1px solid color-mix(in oklab, currentColor 24%, transparent);
  padding:4px 8px; border-radius:6px; backdrop-filter: blur(2px);
  text-transform:uppercase; pointer-events:none;
}

.mschf-plate{
  position:fixed; display:inline-flex; align-items:center; gap:8px; padding:6px 10px;
  background: color-mix(in oklab, #0c0c0c 85%, transparent);
  color: color-mix(in oklab, currentColor 85%, #fff 15%);
  border:1px solid color-mix(in oklab, currentColor 22%, transparent); border-radius:6px;
  box-shadow: 0 0 0 1px rgba(255,255,255,.04) inset, 0 8px 18px rgba(0,0,0,.4);
}
.mschf-barcode{
  width:120px; height:20px; filter:contrast(180%);
  background-image: repeating-linear-gradient(90deg, currentColor 0 2px, transparent 2px 4px);
}
.mschf-code{ font:600 10px/1.1 ui-monospace, SFMono-Regular, Menlo, monospace; opacity:.85 }

/* ————————————————— Lab / blueprint ————————————————— */

.mschf-callout{
  position:fixed; left: calc(var(--x) - 0.5vw); top: var(--y);
  color: color-mix(in oklab, currentColor 90%, #fff 10%);
  font:700 10px/1 ui-monospace, Menlo, monospace; letter-spacing:.06em; text-transform:uppercase;
  padding:4px 6px; border:1px solid color-mix(in oklab,currentColor 30%, transparent); border-radius:6px;
  background: color-mix(in oklab, #0b0b0e 76%, transparent); backdrop-filter: blur(1.5px);
}
.mschf-callout::after{
  content:""; position:fixed; left: var(--x); top: var(--y); width:1px; height: var(--len);
  background: currentColor; transform: translateX(-0.5px);
}

.mschf-graph{ position:fixed; inset:0; pointer-events:none }
.mschf-graph-node{
  position:fixed; width:6px; height:6px; border-radius:50%;
  background: currentColor; opacity:.7;
  box-shadow:0 0 10px color-mix(in oklab,currentColor 50%, transparent);
  left: var(--x); top: var(--y);
}
.mschf-graph-edge{ position:fixed; left:0; top:0; width:0; height:0; pointer-events:none }
.mschf-graph-edge::before{
  content:""; position:fixed; left: var(--x1); top: var(--y1);
  width: calc(var(--x2) - var(--x1)); height: 1px;
  background: linear-gradient(to right, currentColor, color-mix(in oklab,currentColor 0%, transparent));
  transform-origin: 0 0;
  transform: translateY(calc(var(--y2) - var(--y1))) rotate(calc(atan2((var(--y2) - var(--y1)), (var(--x2) - var(--x1))) * 1rad));
}

.mschf-rings{
  position:fixed; pointer-events:none; border-radius:50%;
  background:
    radial-gradient(circle at 50% 50%, color-mix(in oklab,currentColor 25%, transparent) 0 2px, transparent 3px),
    radial-gradient(circle at 50% 50%, color-mix(in oklab,currentColor 20%, transparent) 0 28%, transparent 29%),
    radial-gradient(circle at 50% 50%, color-mix(in oklab,currentColor 14%, transparent) 0 52%, transparent 53%);
  animation: rings 8s ease-in-out infinite alternate;
  mix-blend-mode:screen; opacity:.18;
}
.mschf-rings.static{ animation:none }
@keyframes rings { from{ transform: scale(1) } to{ transform: scale(1.06) } }

.mschf-topo{
  position:fixed; inset:0; pointer-events:none; mix-blend-mode:screen;
  background:
    repeating-conic-gradient(from 0deg, color-mix(in oklab,currentColor 8%, transparent) 0 20deg, transparent 20deg 40deg),
    repeating-radial-gradient(circle at 22% 33%, color-mix(in oklab,currentColor 6%, transparent) 0 6px, transparent 6px 12px);
  transform: rotate(var(--rot, 0deg));
}

.mschf-halftone{
  position:fixed; width:48vmax; height:48vmax; pointer-events:none;
  background-image: radial-gradient(circle at 1px 1px, currentColor 1.3px, transparent 1.6px);
  background-size: 6px 6px; opacity:.10; mix-blend-mode:screen;
}
.mschf-halftone.tl{ top:-10vmax; left:-10vmax } .mschf-halftone.tr{ top:-10vmax; right:-10vmax }
.mschf-halftone.bl{ bottom:-10vmax; left:-10vmax } .mschf-halftone.br{ bottom:-10vmax; right:-10vmax }

.mschf-perf{ position:fixed; pointer-events:none }
.mschf-perf[data-side="top"]{ inset:0 0 auto 0; height:18px; background:
  radial-gradient(circle at 9px 9px, currentColor 2px, transparent 3px) repeat-x 0 50%;
}
.mschf-perf[data-side="bottom"]{ inset:auto 0 0 0; height:18px; background:
  radial-gradient(circle at 9px 9px, currentColor 2px, transparent 3px) repeat-x 0 50%;
}
.mschf-perf[data-side="left"]{ inset:0 auto 0 0; width:18px; background:
  radial-gradient(circle at 9px 9px, currentColor 2px, transparent 3px) repeat-y 50% 0;
}
.mschf-perf[data-side="right"]{ inset:0 0 0 auto; width:18px; background:
  radial-gradient(circle at 9px 9px, currentColor 2px, transparent 3px) repeat-y 50% 0;
}

.mschf-specimen{
  position:fixed; display:inline-grid; grid-auto-flow:row; gap:2px; padding:8px 10px; border-radius:6px; pointer-events:none;
  background: color-mix(in oklab, #0b0b0e 85%, transparent);
  color: color-mix(in oklab, currentColor 85%, #fff 15%);
  border:1px solid color-mix(in oklab, currentColor 22%, transparent);
  box-shadow: 0 0 0 1px rgba(255,255,255,.04) inset, 0 8px 18px rgba(0,0,0,.4);
  font:600 10px/1.1 ui-monospace, Menlo, monospace; text-transform:uppercase; letter-spacing:.06em;
}
.mschf-specimen > strong{ font-weight:800; letter-spacing:.12em }

.mschf-stars{
  position:fixed; inset:0; pointer-events:none; mix-blend-mode:screen; opacity:.12;
  --density:.25;
  background-image:
    radial-gradient(1px 1px at 20% 30%, currentColor 1px, transparent 1.5px),
    radial-gradient(1px 1px at 60% 70%, currentColor 1px, transparent 1.5px),
    radial-gradient(1px 1px at 80% 40%, currentColor 1px, transparent 1.5px),
    radial-gradient(1px 1px at 35% 85%, currentColor 1px, transparent 1.5px);
  filter: saturate(calc(80% + var(--density)*40%));
}

/* ————————————————— Frame & stickers ————————————————— */

.mschf-brackets{ position:fixed; inset:0; pointer-events:none }
.mschf-brackets::before,
.mschf-brackets::after{
  content:""; position:fixed; width:28vmin; height:28vmin; border:4px solid currentColor; opacity:.18;
}
.mschf-brackets.tight::before{ top:5vmin; left:5vmin; border-right:none; border-bottom:none }
.mschf-brackets.tight::after { bottom:5vmin; right:5vmin; border-left:none; border-top:none }
.mschf-brackets.wide::before { top:2vmin; left:2vmin; border-right:none; border-bottom:none }
.mschf-brackets.wide::after  { bottom:2vmin; right:2vmin; border-left:none; border-top:none }

.mschf-glitch{ position:fixed; height:12px;
  background: linear-gradient(90deg, color-mix(in oklab,currentColor 60%, transparent) 0%, color-mix(in oklab,currentColor 10%, transparent) 100%);
  mix-blend-mode:screen; opacity:.18; animation: glitch 3.5s cubic-bezier(.4,.0,.2,1) infinite;
}
.mschf-glitch.static{ animation:none }
@keyframes glitch { 0%{ transform: translateY(0) } 20%{ transform: translateY(-4px) } 50%{ transform: translateY(2px) } 80%{ transform: translateY(-1px) } 100%{ transform: translateY(0) } }

.mschf-ruler{ position:fixed; pointer-events:none; color: color-mix(in oklab,currentColor 85%, #fff 15%) }
.mschf-ruler-top{ top:0; left:0; right:0; height:18px;
  background: linear-gradient(to right, currentColor 1px, transparent 1px) repeat-x 0 100% / 10px 1px;
}
.mschf-ruler-left{ top:0; left:0; bottom:0; width:18px;
  background: linear-gradient(to bottom, currentColor 1px, transparent 1px) repeat-y 100% 0 / 1px 10px;
}

.mschf-watermark{
  position:fixed; inset:0; pointer-events:none; overflow:hidden; opacity:.08; mix-blend-mode:overlay;
  font:700 14px/1.6 ui-monospace, Menlo, monospace; letter-spacing:.2em; text-transform:uppercase;
  color: color-mix(in oklab,currentColor 85%, #fff 15%);
  transform: rotate(-18deg); display:flex; align-items:center; justify-content:center;
}

/* Stickers */
.mschf-stickers{ position:fixed; display:flex; gap:6px; pointer-events:none }
.mschf-badge{
  display:inline-block; padding:6px 8px; border-radius:10px;
  background: color-mix(in oklab, currentColor 22%, transparent);
  color: color-mix(in oklab, #fff 92%, currentColor 8%);
  font:800 10px/1 ui-monospace, Menlo, monospace; letter-spacing:.08em;
  box-shadow: 0 1px 0 rgba(0,0,0,.6), 0 10px 18px rgba(0,0,0,.35);
  transform: translate(var(--offx,0), var(--offy,0)) rotate(var(--rx,0));
}

/* Hyper-floral decal */
.mschf-flower{
  position:absolute; pointer-events:none;
  background:
    radial-gradient(circle at 50% 50%, #fff 0 22%, #111 23% 25%, transparent 26%),
    conic-gradient(from 0deg, #ff1cf7, #00e0ff, #9aff00, #ff1cf7);
  -webkit-mask:
    radial-gradient(closest-side, transparent 48%, #000 49%),
    radial-gradient(closest-side, #000 52%, transparent 53%);
  mask-composite: add; border-radius:50%;
  box-shadow: 0 0 12px color-mix(in oklab, currentColor 35%, transparent);
}

/* Holographic sweep */
.mschf-holo{
  position:fixed; inset:auto 0 0 0; height:22vh; pointer-events:none; mix-blend-mode:screen; opacity:.22;
  background: linear-gradient(90deg, oklch(0.87 0.23 330) , oklch(0.9 0.17 190) , oklch(0.92 0.18 120) , oklch(0.92 0.2 80) , oklch(0.87 0.23 330));
  background-size: 200% 100%; animation: holo-pan 8s linear infinite;
}
.mschf-holo.static{ animation:none }
@keyframes holo-pan { 0%{ background-position:0% 0 } 100%{ background-position:200% 0 } }

/* Registration marks */
.mschf-reg{ position:fixed; width:22px; height:22px; pointer-events:none; opacity:.45;
  filter:drop-shadow(0 0 4px color-mix(in oklab,currentColor 30%, transparent));
}
.mschf-reg::before, .mschf-reg::after{ content:""; position:absolute; background:currentColor }
.mschf-reg::before{ left:50%; top:0; width:1px; height:100%; transform:translateX(-50%) }
.mschf-reg::after{ top:50%; left:0; height:1px; width:100%; transform:translateY(-50%) }
.mschf-reg.tl{ top:8px; left:8px } .mschf-reg.tr{ top:8px; right:8px }
.mschf-reg.bl{ bottom:8px; left:8px } .mschf-reg.br{ bottom:8px; right:8px }

/* Blueprint dimensions */
.mschf-dims{
  position:fixed; pointer-events:none; color: color-mix(in oklab, currentColor 85%, #fff 15%);
  top: var(--y); left: 0; right: 0;
  font:700 10px/1 ui-monospace, Menlo, monospace; letter-spacing:.06em; text-shadow: 0 1px 0 rgba(0,0,0,.5);
  padding-top:6px; padding-left: calc(var(--x1) + 10px); width: calc(var(--x2) - var(--x1));
}
.mschf-dims::before, .mschf-dims::after, .mschf-dims span{ content:""; position:fixed; top:var(--y); height:1px; background: currentColor }
.mschf-dims::before{ left: var(--x1); right: calc(100vw - var(--x2)) }
.mschf-dims::after{ left: var(--x1); width: 8px; transform: translateY(-6px) rotate(45deg) }
.mschf-dims span{ right: calc(100vw - var(--x2)); width: 8px; transform: translateY(6px) rotate(-45deg) }

/* Rulers subtle */
.mschf-ruler-top, .mschf-ruler-left{ opacity:.18; mix-blend-mode:screen }

/* ————————————————— Mobile tuning ————————————————— */

@media (max-width: 479.98px){
  /* XS: band-only vibe: scaffold retained, most ornaments suppressed by JS. */
  .mschf-grid{ opacity:.06; background-size: 24px 24px !important; }
  .mschf-frame{ box-shadow:
    inset 0 0 0 1px color-mix(in oklab,currentColor 18%,transparent),
    inset 0 0 16px color-mix(in oklab,currentColor 8%,transparent) }
  .mschf-quotes,.mschf-stamp,.mschf-stickers,.mschf-dims,.mschf-plate,.mschf-specimen,
  .mschf-rings,.mschf-topo,.mschf-halftone,.mschf-crt,.mschf-holo,.mschf-perf,.mschf-brackets,.mschf-glitch,
  .mschf-stars { display:none !important; }
}

@media (min-width: 480px) and (max-width: 767.98px){
  .mschf-rings{ opacity:.14 }
  .mschf-topo{ opacity:.06 }
  .mschf-glitch{ opacity:.12 }
  .mschf-watermark{ opacity:.06 }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce){
  .mschf-holo{ animation:none }
  .mschf-rings{ animation:none }
  .mschf-glitch{ animation:none }
}
