---
layout: base.njk
fullBleed: true
metaDisable: true
---
# dprint-ignore-file

{% set data = lvreport or {} %}
{% set totals = data.totals or {} %}
{% set navigation = data.navigation or [] %}
{% set gallery = data.gallery or {} %}
{% set galleryPreview = gallery.preview or {} %}
{% set galleryItems = galleryPreview.items or [] %}
{% set highlights = data.highlights or {} %}
{% set latestImages = highlights.latestImages or [] %}
{% set highlightHosts = highlights.hosts or [] %}
{% set duplicateData = data.duplicates or {} %}
{% set duplicateSummary = duplicateData.summary or {} %}
{% set duplicateClusters = duplicateData.clusters or [] %}
{% set pagesReport = data.pagesReport or {} %}
{% set pagesItems = pagesReport.items or [] %}
{% set hostStats = data.hostStats or [] %}
{% set dataset = data.dataset or {} %}
{% set datasetWarnings = dataset.warnings or [] %}
{% set datasetFlags = dataset.flags or [] %}
{% set datasetCapture = dataset.capture or [] %}
{% set runsHistory = data.runsHistory or [] %}
{% set robots = data.robots or [] %}
{% set docs = data.docs or [] %}
{% set sitemaps = data.sitemaps or [] %}
{% set metrics = data.metrics or {} %}
{% set robotMetrics = metrics.robots or {} %}
{% set docsMetrics = metrics.docs or {} %}
{% set itemsMetrics = metrics.items or {} %}
{% set search = data.search or {} %}
{% set placeholderSrc = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==' %}
{% set galleryPageSizes = gallery.pageSizes or [] %}

<script type="application/json" id="lvreport-data">{{ clientPayloadJson | safe }}</script>
<script type="module" src="/assets/js/lvreport-app.js"></script>

<section id="overview" class="relative overflow-hidden rounded-box bg-gradient-to-br from-primary via-secondary to-accent p-8 text-primary-content shadow-2xl">
  <div class="absolute inset-0 pointer-events-none opacity-35 mix-blend-screen bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.5),_transparent_65%)]"></div>
  <div class="relative grid gap-8 lg:grid-cols-[minmax(0,1fr)_minmax(0,320px)] items-start">
    <div>
      <h1 class="text-4xl font-extrabold tracking-tight">LV Image Atlas</h1>
      <p class="mt-4 max-w-2xl text-sm md:text-base opacity-90">
        A dimension-agnostic exploration of {{ totals.images or 0 }} catalogued images across
        {{ totals.hosts or 0 }} hosts and {{ totals.products or 0 }} source pages. Hotlinks stay live; deprecations remain visible.
      </p>
      {% if navigation and navigation | length %}
        <div class="mt-6 flex flex-wrap gap-2">
          {% for entry in navigation %}
            <a href="{{ entry.href }}" class="btn btn-xs md:btn-sm border-primary/50 bg-base-100/20 text-primary-content hover:bg-primary/20">
              {{ entry.title }}
              {% if entry.totalItems %}
                <span class="badge badge-xs ml-2 border-primary/40 bg-primary/30 text-primary-content/70">{{ entry.totalItems }}</span>
              {% endif %}
            </a>
          {% endfor %}
        </div>
      {% endif %}
      <div class="mt-10 grid gap-4 sm:grid-cols-2 xl:grid-cols-3">
        <div class="stats shadow-lg bg-base-100/90 text-base-content">
          <div class="stat">
            <div class="stat-title uppercase tracking-wide text-xs">Active images</div>
            <div class="stat-value text-3xl">{{ totals.activeImages or 0 }}</div>
            <div class="stat-desc text-xs opacity-70">{{ totals.deprecatedImages or 0 }} deprecated kept visible</div>
          </div>
        </div>
        <div class="stats shadow-lg bg-base-100/90 text-base-content">
          <div class="stat">
            <div class="stat-title uppercase tracking-wide text-xs">Duplicate relationships</div>
            <div class="stat-value text-3xl">{{ duplicateSummary.duplicateImages or totals.duplicateImages or 0 }}</div>
            <div class="stat-desc text-xs opacity-70">{{ duplicateSummary.clusters or 0 }} clusters detected</div>
          </div>
        </div>
        <div class="stats shadow-lg bg-base-100/90 text-base-content">
          <div class="stat">
            <div class="stat-title uppercase tracking-wide text-xs">Robots health</div>
            <div class="stat-value text-3xl">{{ robotMetrics.total or 0 }}</div>
            <div class="stat-desc text-xs opacity-70">{{ robotMetrics.issues or 0 }} flagged directives</div>
          </div>
        </div>
        <div class="stats shadow-lg bg-base-100/90 text-base-content">
          <div class="stat">
            <div class="stat-title uppercase tracking-wide text-xs">Cached documents</div>
            <div class="stat-value text-3xl">{{ docsMetrics.total or 0 }}</div>
            <div class="stat-desc text-xs opacity-70">{{ docsMetrics.issues or 0 }} require review</div>
          </div>
        </div>
        <div class="stats shadow-lg bg-base-100/90 text-base-content">
          <div class="stat">
            <div class="stat-title uppercase tracking-wide text-xs">Items processed</div>
            <div class="stat-value text-3xl">{{ itemsMetrics.total or 0 }}</div>
            <div class="stat-desc text-xs opacity-70">{{ itemsMetrics.active or 0 }} active · {{ itemsMetrics.removed or 0 }} removed</div>
          </div>
        </div>
        <div class="stats shadow-lg bg-base-100/90 text-base-content">
          <div class="stat">
            <div class="stat-title uppercase tracking-wide text-xs">Dataset bundle</div>
            <div class="stat-value text-3xl">{{ dataset.totals and dataset.totals.sizeLabel or 'n/a' }}</div>
            <div class="stat-desc text-xs opacity-70">{{ dataset.totals and dataset.totals.bundleSizeLabel or 'tgz size unknown' }}</div>
          </div>
        </div>
      </div>
    </div>
    <aside class="rounded-box bg-base-100/90 p-4 text-base-content shadow-lg">
      <h2 class="text-sm font-semibold uppercase tracking-wide text-base-content/70">Dataset status</h2>
      <div class="mt-3 space-y-3 text-sm">
        {% if datasetWarnings and datasetWarnings | length %}
          <div class="rounded-box border border-warning/40 bg-warning/10 p-3">
            <p class="font-semibold text-warning">Warnings</p>
            <ul class="mt-2 space-y-1 text-warning-content/90">
              {% for warning in datasetWarnings %}
                <li>• {{ warning }}</li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
        {% if datasetFlags and datasetFlags | length %}
          <div class="rounded-box border border-error/40 bg-error/10 p-3">
            <p class="font-semibold text-error">Flags</p>
            <ul class="mt-2 space-y-1 text-error-content/90">
              {% for flag in datasetFlags %}
                <li>• {{ flag }}</li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
        <div class="space-y-2">
          <a href="{{ dataset.archiveHref or data.baseHref }}" class="btn btn-sm w-full border-primary/40 bg-primary/20 text-primary-content hover:bg-primary/40" target="_blank" rel="noreferrer">
            Browse generated bundle
          </a>
          {% if dataset.manifestHref %}
            <a href="{{ dataset.manifestHref }}" class="btn btn-sm w-full border-base-content/40 bg-base-200/70 text-base-content hover:bg-base-300" target="_blank" rel="noreferrer">
              Bundle provenance
            </a>
          {% endif %}
        </div>
        {% if runsHistory and runsHistory | length %}
          <div class="mt-4 space-y-1 text-xs opacity-80">
            <p class="font-semibold text-base-content/80">Latest runs</p>
            {% for run in runsHistory | slice(0,5) %}
              <p>{{ run.generatedAt or run.finishedAt or run.startedAt }} · {{ run.mode or 'capture' }}</p>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </aside>
  </div>
</section>

{% if latestImages and latestImages | length %}
  <section id="fresh" class="mt-16">
    <div class="flex flex-wrap items-center justify-between gap-4">
      <div>
        <h2 class="text-2xl font-bold text-base-content">Fresh arrivals</h2>
        <p class="text-sm text-base-content/70">Latest 18 captures by last seen timestamp.</p>
      </div>
      {% if highlightHosts and highlightHosts | length %}
        <div class="flex flex-wrap gap-2 text-xs text-base-content/70">
          {% for host in highlightHosts %}
            <span class="rounded-full border border-base-content/20 px-3 py-1">{{ host.host or host }}</span>
          {% endfor %}
        </div>
      {% endif %}
    </div>
    <div class="mt-6 overflow-x-auto pb-2">
      <div class="flex min-w-full gap-4">
        {% for image in latestImages %}
          {% set isPriority = loop.index0 < 6 %}
          <a href="{{ image.pageUrl or image.src }}" class="group relative w-[180px] shrink-0 overflow-hidden rounded-2xl border border-base-200 bg-base-100 shadow-md transition hover:-translate-y-1 hover:shadow-xl" target="_blank" rel="noreferrer" title="Open source page">
            <div class="aspect-[4/5] overflow-hidden bg-base-200">
              <img
                src="{{ placeholderSrc }}"
                data-src="{{ image.src }}"
                data-lv-lazy-static
                {% if isPriority %}data-lv-priority="high"{% endif %}
                alt="{{ image.title or image.basename or image.id }}"
                loading="lazy"
                decoding="async"
                class="h-full w-full object-cover transition group-hover:scale-105"
              />
            </div>
            <div class="space-y-1 p-3 text-xs">
              <p class="line-clamp-1 font-semibold text-base-content">{{ image.basename or image.title or image.id }}</p>
              <p class="line-clamp-1 text-base-content/70">{{ image.host }}</p>
              <p class="text-[10px] uppercase tracking-wide text-base-content/50">Last seen {{ image.lastSeen or image.firstSeen or 'unknown' }}</p>
              {% if image.isDeprecated %}
                <span class="badge badge-xs border-error/60 bg-error/10 text-error">Deprecated</span>
              {% endif %}
            </div>
          </a>
        {% endfor %}
      </div>
    </div>
    <noscript>
      <div class="mt-6 grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
        {% for image in latestImages %}
          <article class="overflow-hidden rounded-2xl border border-base-200 bg-base-100 shadow-md">
            <a href="{{ image.pageUrl or image.src }}" target="_blank" rel="noreferrer" class="block">
              <img src="{{ image.src }}" alt="{{ image.title or image.basename or image.id }}" class="aspect-[4/5] w-full object-cover" />
            </a>
            <div class="space-y-1 p-3 text-xs">
              <p class="line-clamp-1 font-semibold text-base-content">{{ image.basename or image.title or image.id }}</p>
              <p class="line-clamp-1 text-base-content/70">{{ image.host }}</p>
              <p class="text-[10px] uppercase tracking-wide text-base-content/50">Last seen {{ image.lastSeen or image.firstSeen or 'unknown' }}</p>
              {% if image.isDeprecated %}
                <span class="badge badge-xs border-error/60 bg-error/10 text-error">Deprecated</span>
              {% endif %}
            </div>
          </article>
        {% endfor %}
      </div>
    </noscript>
  </section>
{% endif %}

<section id="gallery" class="mt-20">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <div>
      <h2 class="text-3xl font-bold text-base-content">Gallery</h2>
      <p class="text-sm text-base-content/70">Explore {{ gallery.totalItems or 0 }} images without caching. Filters update instantly.</p>
    </div>
    <div class="flex items-center gap-2 text-xs text-base-content/60">
      <span class="rounded-full border border-base-content/20 px-3 py-1">{{ gallery.totalItems or 0 }} images tracked</span>
      <span class="rounded-full border border-base-content/20 px-3 py-1">{{ (gallery.hosts or []) | length }} hosts</span>
    </div>
  </div>

  <noscript>
    <div class="mt-8 grid gap-6 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4">
      {% for image in galleryItems | slice(0,16) %}
        <article class="flex flex-col overflow-hidden rounded-3xl border border-base-200 bg-base-100 shadow-lg">
          <a href="{{ image.pageUrl or image.src }}" target="_blank" rel="noreferrer" class="block">
            <img src="{{ image.src }}" alt="{{ image.title or image.basename or image.id }}" class="aspect-[4/5] w-full object-cover" />
          </a>
          <div class="space-y-2 p-4 text-sm">
            <div class="flex items-center justify-between gap-2">
              <h3 class="line-clamp-1 font-semibold text-base-content">{{ image.basename or image.title or image.id }}</h3>
              {% if image.isDeprecated %}
                <span class="badge badge-xs border-error/60 bg-error/10 text-error">Deprecated</span>
              {% endif %}
            </div>
            <a href="{{ image.pageUrl or image.src }}" target="_blank" rel="noreferrer" class="line-clamp-2 text-xs text-primary">{{ image.pageUrl or image.src }}</a>
            <div class="flex flex-wrap gap-2 text-[11px] text-base-content/60">
              <span class="rounded-full border border-base-content/20 px-2 py-1">{{ image.host or 'unknown host' }}</span>
              {% if image.duplicateOf %}
                <span class="rounded-full border border-warning/40 bg-warning/10 px-2 py-1 text-warning">Duplicate</span>
              {% endif %}
              <span>Seen {{ image.lastSeen or image.firstSeen or 'unknown' }}</span>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>
  </noscript>

  <div class="js-gallery mt-8" x-data="lvGalleryApp()" x-init="init()" x-cloak>
    <div class="rounded-box border border-base-200 bg-base-100/95 p-4 shadow-lg">
      <div class="flex flex-wrap items-center gap-3">
        <label class="input input-bordered flex-1 min-w-[200px]">
          <span class="pr-2 text-sm text-base-content/60">Search</span>
          <input type="search" placeholder="host, basename, title" x-model.debounce.250ms="filters.query" class="min-w-[160px] flex-1 bg-transparent focus:outline-none" />
        </label>
        <select class="select select-bordered min-w-[160px]" x-model="filters.host">
          <option value="">All hosts</option>
          <template x-for="host in facets.hosts" :key="host.host">
            <option :value="host.host" x-text="`${host.host} (${host.images})`"></option>
          </template>
        </select>
        <select class="select select-bordered min-w-[150px]" x-model="filters.bucket">
          <option value="">All months</option>
          <template x-for="bucket in facets.buckets" :key="bucket.key">
            <option :value="bucket.key" x-text="`${bucket.label} (${bucket.count})`"></option>
          </template>
        </select>
        <select class="select select-bordered min-w-[140px]" x-model="filters.state">
          <option value="active">Active only</option>
          <option value="all">All images</option>
          <option value="deprecated">Deprecated only</option>
        </select>
        <select class="select select-bordered min-w-[140px]" x-model="sort">
          <option value="recent">Newest first</option>
          <option value="host">Host A → Z</option>
          <option value="name">Basename A → Z</option>
          <option value="duplicates">Duplicates first</option>
        </select>
        <select class="select select-bordered min-w-[130px]" x-model.number="pageSize">
          <template x-for="option in pageSizeOptions" :key="option">
            <option :value="option" x-text="`${option} / page`"></option>
          </template>
        </select>
        <label class="label cursor-pointer gap-2 text-sm text-base-content/70">
          <span>Duplicates only</span>
          <input type="checkbox" class="toggle toggle-sm" x-model="filters.duplicates" />
        </label>
      </div>
      <div class="mt-4 flex flex-wrap items-center justify-between gap-3 text-xs text-base-content/70">
        <p>
          Showing <span class="font-semibold text-base-content" x-text="visibleCount"></span>
          of {{ gallery.totalItems or 0 }} images
        </p>
        <div class="flex items-center gap-2">
          <button class="btn btn-xs border-base-content/30 bg-base-200" @click="prevPage" :disabled="pageIndex === 0">Prev</button>
          <span class="rounded-full border border-base-content/20 px-3 py-1">Page <span x-text="pageIndex + 1"></span> / <span x-text="expectedPageCount"></span></span>
          <button class="btn btn-xs border-base-content/30 bg-base-200" @click="nextPage" :disabled="pageIndex + 1 >= expectedPageCount">Next</button>
          <template x-if="datasetError">
            <button class="btn btn-xs border-error/40 bg-error/10 text-error" @click="retryDataset">Retry dataset</button>
          </template>
          <template x-if="!datasetError">
            <span class="badge border-primary/30 bg-primary/10 text-primary-content/80 flex items-center gap-1" :class="datasetLoaded ? 'border-success/30 bg-success/10 text-success' : ''">
              <span class="loading loading-spinner loading-xs" x-show="loading"></span>
              <span x-text="datasetStatusLabel"></span>
            </span>
          </template>
        </div>
      </div>
    </div>
    <div class="mt-6 grid gap-6 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4">
      <template x-for="(image, index) in pageItems" :key="image.id">
        <a :href="image.pageUrl || image.src" target="_blank" rel="noreferrer" class="group flex flex-col overflow-hidden rounded-3xl border border-base-200 bg-base-100 shadow-lg transition hover:-translate-y-1 hover:shadow-xl" :title="image.pageUrl || image.src">
          <div class="aspect-[4/5] overflow-hidden bg-base-200">
            <img
              src="{{ placeholderSrc }}"
              :data-src="image.src"
              :alt="image.title || image.basename || image.id"
              loading="lazy"
              decoding="async"
              class="h-full w-full object-cover transition group-hover:scale-105"
              x-init="registerImage($el, index < 6)"
            />
          </div>
          <div class="flex flex-1 flex-col justify-between space-y-3 p-4 text-sm">
            <div class="space-y-1">
              <div class="flex items-center justify-between gap-2">
                <h3 class="line-clamp-1 font-semibold text-base-content" x-text="image.basename || image.title || image.id"></h3>
                <template x-if="image.isDeprecated">
                  <span class="badge badge-xs border-error/60 bg-error/10 text-error">Deprecated</span>
                </template>
              </div>
              <a :href="image.pageUrl || image.src" target="_blank" rel="noreferrer" class="line-clamp-2 text-xs text-primary/80 hover:text-primary" x-text="image.pageUrl || image.src"></a>
            </div>
            <div class="flex flex-wrap items-center gap-2 text-[11px] text-base-content/60">
              <button class="rounded-full border border-base-content/20 px-2 py-1 transition hover:border-primary hover:text-primary" type="button" @click.stop="setHostFilter(image.host)">
                <span x-text="image.host || 'unknown host'"></span>
              </button>
              <template x-if="image.duplicateOf">
                <span class="rounded-full border border-warning/40 bg-warning/10 px-2 py-1 text-warning">Duplicate</span>
              </template>
              <span x-text="image.lastSeen || image.firstSeen || 'unknown'"></span>
            </div>
          </div>
        </a>
      </template>
      <template x-if="!pageItems.length">
        <div class="col-span-full rounded-box border border-dashed border-base-content/30 p-8 text-center text-sm text-base-content/60">
          No images match the current filters.
        </div>
      </template>
    </div>
  </div>
</section>

<section id="duplicates" class="mt-24">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <div>
      <h2 class="text-3xl font-bold text-base-content">Duplicate clusters</h2>
      <p class="text-sm text-base-content/70">Clusters share canonical IDs; hotlinks remain direct.</p>
    </div>
    <div class="flex items-center gap-2 text-xs text-base-content/60">
      <span class="rounded-full border border-base-content/20 px-3 py-1">{{ duplicateSummary.clusters or 0 }} clusters</span>
      <span class="rounded-full border border-base-content/20 px-3 py-1">{{ duplicateSummary.duplicateImages or 0 }} duplicate images</span>
    </div>
  </div>
  <div class="mt-8 grid gap-6 lg:grid-cols-2">
    {% for cluster in duplicateClusters | slice(0,60) %}
      <article class="flex flex-col gap-4 overflow-hidden rounded-3xl border border-base-200 bg-base-100 shadow-lg">
        <div class="flex gap-3 overflow-x-auto bg-base-200/60 p-4">
          {% set members = cluster.members or [] %}
          {% for member in members %}
            <a href="{{ member.pageUrl or member.src }}" target="_blank" rel="noreferrer" class="relative h-24 w-24 shrink-0 overflow-hidden rounded-2xl border border-base-200 bg-base-100">
              <img
                src="{{ placeholderSrc }}"
                data-src="{{ member.src }}"
                data-lv-lazy-static
                {% if loop.index0 < 2 %}data-lv-priority="high"{% endif %}
                alt="{{ member.title or member.basename or member.id }}"
                loading="lazy"
                decoding="async"
                class="h-full w-full object-cover"
              />
              {% if member.id == cluster.canonicalId %}
                <span class="absolute left-1 top-1 rounded-full border border-success/60 bg-success/20 px-2 text-[10px] font-semibold uppercase tracking-wide text-success">Canonical</span>
              {% endif %}
              {% if member.isDeprecated %}
                <span class="absolute right-1 bottom-1 rounded-full border border-error/60 bg-error/20 px-2 text-[10px] font-semibold uppercase tracking-wide text-error">Deprecated</span>
              {% endif %}
            </a>
          {% endfor %}
        </div>
        <div class="space-y-2 px-5 pb-5 text-sm">
          <p class="font-semibold text-base-content">{{ cluster.canonical and (cluster.canonical.title or cluster.canonical.basename) or cluster.canonicalId }}</p>
          <div class="flex flex-wrap gap-3 text-xs text-base-content/70">
            <span class="rounded-full border border-base-content/20 px-3 py-1">{{ cluster.count }} members</span>
            <span class="rounded-full border border-base-content/20 px-3 py-1">First {{ cluster.firstSeen or 'unknown' }}</span>
            <span class="rounded-full border border-base-content/20 px-3 py-1">Last {{ cluster.lastSeen or 'unknown' }}</span>
          </div>
          <p class="text-xs text-base-content/60">{{ cluster.canonical and cluster.canonical.pageUrl }}</p>
        </div>
      </article>
    {% endfor %}
  </div>
</section>

<section id="pages" class="mt-24">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <div>
      <h2 class="text-3xl font-bold text-base-content">Source pages</h2>
      <p class="text-sm text-base-content/70">Every page remains hotlinked; deprecated images stay in the count.</p>
    </div>
    <span class="rounded-full border border-base-content/20 px-3 py-1 text-xs text-base-content/60">{{ pagesReport.total or 0 }} pages</span>
  </div>
  <div class="mt-6 overflow-x-auto rounded-3xl border border-base-200 bg-base-100 shadow-lg">
    <table class="table table-zebra w-full text-sm">
      <thead class="bg-base-200/80 text-xs uppercase tracking-wide text-base-content/70">
        <tr>
          <th class="whitespace-nowrap">Page</th>
          <th>Host</th>
          <th class="text-right">Images</th>
          <th class="text-right">Unique</th>
          <th class="text-right">Duplicates</th>
          <th class="text-right">Deprecated</th>
          <th>First seen</th>
          <th>Last seen</th>
        </tr>
      </thead>
      <tbody>
        {% for page in pagesItems | slice(0,200) %}
          <tr>
            <td class="max-w-[260px]">
              {% if page.pageUrl %}
                <a href="{{ page.pageUrl }}" class="link link-hover text-base-content" target="_blank" rel="noreferrer">{{ page.title or page.pageUrl }}</a>
              {% else %}
                {{ page.title or page.pageUrl or page.id }}
              {% endif %}
            </td>
            <td class="text-xs text-base-content/70">{{ page.host }}</td>
            <td class="text-right font-semibold text-base-content">{{ page.totalImages or 0 }}</td>
            <td class="text-right text-base-content/70">{{ page.uniqueImages or 0 }}</td>
            <td class="text-right text-warning">{{ page.duplicateImages or 0 }}</td>
            <td class="text-right text-error">{{ page.deprecatedImages or 0 }}</td>
            <td class="text-xs text-base-content/70">{{ page.firstSeen or '—' }}</td>
            <td class="text-xs text-base-content/70">{{ page.lastSeen or '—' }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    {% if pagesItems | length > 200 %}
      <div class="border-t border-base-200 p-4 text-xs text-base-content/60">Showing 200 of {{ pagesItems | length }} pages — refine via gallery filters for specifics.</div>
    {% endif %}
  </div>
</section>

<section id="robots" class="mt-24">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <div>
      <h2 class="text-3xl font-bold text-base-content">Robots.txt snapshots</h2>
      <p class="text-sm text-base-content/70">Decoded where possible; classification flags issues quickly.</p>
    </div>
    <span class="rounded-full border border-base-content/20 px-3 py-1 text-xs text-base-content/60">{{ robotMetrics.total or 0 }} hosts</span>
  </div>
  <div class="mt-6 grid gap-6 lg:grid-cols-2">
    {% for robot in robots | slice(0,40) %}
      <article class="flex flex-col gap-3 rounded-3xl border border-base-200 bg-base-100 p-5 shadow-lg">
        <div class="flex items-center justify-between gap-3">
          <h3 class="text-lg font-semibold text-base-content">{{ robot.host }}</h3>
          <span class="badge border-{{ robot.statusTone or 'info' }}/60 bg-{{ robot.statusTone or 'info' }}/10 text-{{ robot.statusTone or 'info' }}">{{ robot.statusLabel }}</span>
        </div>
        <div class="flex flex-wrap gap-2 text-xs text-base-content/60">
          <span class="rounded-full border border-base-content/20 px-3 py-1">{{ robot.linesTotal or 0 }} lines</span>
          {% if robot.hasCached %}
            <a href="{{ data.baseHref }}{{ robot.robotsTxtPath }}" class="rounded-full border border-base-content/20 px-3 py-1 text-primary" target="_blank" rel="noreferrer">Cached copy</a>
          {% endif %}
          {% if robot.blacklisted %}
            <span class="rounded-full border border-warning/40 bg-warning/10 px-3 py-1 text-warning">Blacklisted until {{ robot.blacklistUntil }}</span>
          {% endif %}
        </div>
        <p class="line-clamp-4 text-sm text-base-content/70">{{ robot.preview }}</p>
      </article>
    {% endfor %}
  </div>
  {% if robots | length > 40 %}
    <p class="mt-4 text-xs text-base-content/60">Showing 40 of {{ robots | length }} robots snapshots.</p>
  {% endif %}
</section>

<section id="cached-docs" class="mt-24">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <div>
      <h2 class="text-3xl font-bold text-base-content">Cached documents &amp; sitemaps</h2>
      <p class="text-sm text-base-content/70">Quick roll-up of XML/TXT captures and submitted sitemaps.</p>
    </div>
  </div>
  <div class="mt-6 grid gap-6 md:grid-cols-2">
    <div class="rounded-3xl border border-base-200 bg-base-100 p-5 shadow-lg">
      <h3 class="text-lg font-semibold text-base-content">Documents</h3>
      <p class="text-xs text-base-content/60">{{ docsMetrics.total or 0 }} cached · {{ docsMetrics.issues or 0 }} issues</p>
      <ul class="mt-4 space-y-3 text-sm text-base-content/70">
        {% for doc in docs | slice(0,12) %}
          <li class="flex items-start justify-between gap-3">
            <span class="line-clamp-2">{{ doc.fileName }} · {{ doc.host }}</span>
            <span class="badge badge-xs border-{{ doc.statusTone or 'info' }}/60 bg-{{ doc.statusTone or 'info' }}/10 text-{{ doc.statusTone or 'info' }}">{{ doc.statusLabel }}</span>
          </li>
        {% endfor %}
      </ul>
    </div>
    <div class="rounded-3xl border border-base-200 bg-base-100 p-5 shadow-lg">
      <h3 class="text-lg font-semibold text-base-content">Sitemaps</h3>
      <p class="text-xs text-base-content/60">{{ sitemaps | length }} discovered</p>
      <ul class="mt-4 space-y-3 text-sm text-base-content/70">
        {% for sitemap in sitemaps | slice(0,12) %}
          <li class="flex items-start justify-between gap-3">
            <span class="line-clamp-2">{{ sitemap.host }} · {{ sitemap.url }}</span>
            <span class="badge badge-xs border-base-content/20 bg-base-200/70 text-base-content/70">{{ sitemap.type }}</span>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</section>

<section id="search" class="mt-24">
  <div class="rounded-3xl border border-dashed border-base-content/30 bg-base-100/80 p-6 text-center text-sm text-base-content/60">
    <p class="mb-2 font-semibold text-base-content">Global search dataset</p>
    <p class="mb-4">{{ search.documentCount or 0 }} documents indexed for instant search via MiniSearch. Hydration happens client-side.</p>
    {% if gallery.datasetHref %}
      <a href="{{ gallery.datasetHref }}" class="btn btn-sm border-base-content/30 bg-base-200 text-base-content" target="_blank" rel="noreferrer">Download lvreport.dataset.json</a>
    {% endif %}
  </div>
</section>
