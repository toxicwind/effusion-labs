diff --git a/node_modules/tree-cli/tree.js b/node_modules/tree-cli/tree.js
--- a/node_modules/tree-cli/tree.js
+++ b/node_modules/tree-cli/tree.js
@@
-  _spinnerOn = function () {
-    _spinner.setSpinnerString(9);
-    _spinner.start();
-  },
+  _isInteractive = function () {
+    try {
+      return process && process.stdout && process.stdout.isTTY;
+    } catch (e) {
+      return false;
+    }
+  },
+
+  _spinnerOn = function () {
+    if (!_isInteractive()) return;
+    _spinner.setSpinnerString(9);
+    _spinner.start();
+  },
@@
-  _spinnerOff = function () {
-    _spinner.stop(true);
-  },
+  _spinnerOff = function () {
+    try {
+      if (_isInteractive()) {
+        _spinner.stop(true);
+      }
+    } catch (e) {
+      // Swallow EPIPE or similar stream errors when piping output
+    }
+  },
